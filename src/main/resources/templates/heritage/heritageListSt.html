<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default2}">
<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
</th:block>
<th:block layout:fragment="contentsTitle">
	<!-- 페이지 타이틀 시작 -->
	<h2>문화재 상세 페이지</h2>
	<nav aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a th:href="@{/heritage/heritageListByItem}">문화재 종목별 검색 리스트</a></li>
			<li class="breadcrumb-item active" aria-current="page">문화재 상세페이지</li>
		</ol>
	</nav>
	<!-- 페이지 타이틀 종료 -->
</th:block>
<th:block layout:fragment="customContents">
<!-- 추가 CSS 시작 -->
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/buttons.dataTables.min.css}">
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/select.bootstrap4.min.css}">
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/fixedColumns.bootstrap4.min.css}">
<!-- 추가 CSS 종료 -->
	
	<!-- 문화재 리스트 관리자 테이블 시작 -->
	<div class="row">
		<div class="col-lg-12">
			<div class="card">
				<div class="card-body">
					<div class="table-responsive">
					<!-- 검색 박스 include -->
					<div th:include="searchMinSeok/search.html :: searchHeritageListStFragment"></div>
						<table id="table-selected"
							class="table table-striped table-bordered">
							<thead>
								<tr>
									<th>문화재 코드</th>
									<th>문화재 명</th>
									<th>문화재 대분류</th>
									<th>문화재 중분류</th>
									<th>관리자</th>
									<th>소유자</th>
									<th>시대명</th>
									<th>문화재 지정일</th>
									<th>수량/면적</th>
									<th>수정</th>
									<th>삭제</th>
								</tr>
							</thead>
							<tbody class="text-center">
								<tr th:if="${not #lists.isEmpty(heritageList)}"
									th:each="l : ${heritageList}">
									<td th:text="${l.heritageCode}"></td>
									<td th:text="${l.heritageName}"></td>
									<td th:text="${l.heritageClassification}"></td>
									<td th:text="${l.heritageCategory}"></td>
									<td th:text="${l.heritageManager}"></td>
									<td th:text="${l.heritageOwner}"></td>
									<td th:text="${l.heritageEra}"></td>
									<td th:text="${l.heritageDesignation}"></td>
									<td th:text="${l.heritageArea}"></td>
									<td><a 
										class="btn btn-primary btn-icon btn-sm mb-1 mr-2 mb-1"
										th:if="${session.SLEVEL != '일반회원'}"
										th:href="@{/heritage/heritageModify(heritageCode=${l.heritageCode})}"><i
											class="la la-edit"></i> </a>
										<a 
										class="btn btn-primary btn-icon btn-sm mb-1 mr-2 mb-1"
										th:unless="${session.SLEVEL != '일반회원'}"
										onclick="alert('일반회원은 문화재 정보를 수정할 수 없습니다.')"><i
											class="la la-edit"></i> </a>	
											</td>
									<td><button class="btn btn-danger btn-icon btn-sm mb-1"
											th:if="${session.SLEVEL != '일반회원'}"	
											id="swal-delete-heritage"
											th:data-heritageCd="${l.heritageCode}">
											<i class="fa fa-trash-o"></i>
										</button>
										<button class="btn btn-danger btn-icon btn-sm mb-1"
											th:unless="${session.SLEVEL != '일반회원'}"
											onclick="alert('일반회원은 문화재 정보를 삭제할 수 없습니다.')">
											<i class="fa fa-trash-o"></i>
										</button>
										</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 문화재 리스트 관리자 테이블 종료 -->
</th:block>
<th:block layout:fragment="customBodyScript">
	<!-- delbtn -->
	<script th:src="@{/js/sweetalert2/sweetalert2.min.js}" aria-hidden="true"></script>
	<script th:src="@{/js/sweetalert2/sweetalert2-custom.js}" aria-hidden="true"></script>
	<!-- datatables -->
	<script th:src="@{/js/datatables/datatables.js}"></script>
	<script th:src="@{/js/datatables/dataTables.buttons.min.js}"></script>
	<script th:src="@{/js/datatables/buttons.flash.min.js}"></script>
	<script th:src="@{/js/datatables/jszip.min.js}"></script>
	<script th:src="@{/js/datatables/pdfmake.min.js}"></script>
	<script th:src="@{/js/datatables/vfs_fonts.js}"></script>
	<script th:src="@{/js/datatables/buttons.html5.min.js}"></script>
	<script th:src="@{/js/datatables/buttons.print.min.js}"></script>
	<!-- fixedHeader -->
	<script th:src="@{/js/datatables/dataTables.fixedHeader.min.js}"></script>
	<!-- dataTables select -->
	<script th:src="@{/js/datatables/dataTables.select.min.js}"></script>
	<!-- dataTables.fixedColumns.min -->
	<script th:src="@{/js/datatables/dataTables.fixedColumns.min.js}"></script>
	<!-- dataTables.rowGroup.min -->
	<script th:src="@{/js/datatables/dataTables.rowGroup.min.js}"></script>
	<!-- custom -->
	<script th:src="@{/js/custom.js}"></script>
	
	<!-- 삭제 버튼 자바스크립트 -->
	<script>
		$(function(){
			$(document).on('click','#swal-delete-heritage',function(){
				var heritageCd = $(this).attr('data-heritageCd');
			      const swalWithBootstrapButtons = swal.mixin({
			          confirmButtonClass: 'btn btn-success',
			          cancelButtonClass: 'btn btn-danger',
			          buttonsStyling: false,
			        });

			        swalWithBootstrapButtons({
			          title: '정말 삭제 하시겠습니까?',
			          text: "삭제 클릭시 해당 정보는 복구 할 수 없습니다.",
			          type: 'warning',
			          showCancelButton: true,
			          confirmButtonText: '네',
			          cancelButtonText: '아니오',
			          reverseButtons: false
			        }).then((result) => {
			          if (result.value) {
			            swalWithBootstrapButtons(
			              '삭제완료',
			              '파일이 안전하게 삭제되었습니다.',
			              'success'
			            )
			            location.href = '/heritage/heritageRemove?heritageCode=' + heritageCd;
			          } else if (
			            // Read more about handling dismissals
			            result.dismiss === swal.DismissReason.cancel
			          ) {
			            swalWithBootstrapButtons(
			              '취소',
			              '사진은 안전하게 보호됩니다.',
			              'error'
			            )
			          }
			        });

				    			
			});
			
		});
	</script>
</th:block>
</html>